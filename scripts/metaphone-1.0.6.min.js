!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).metaphone=e()}}(function(){var e="X",a="0";function r(e){return"E"===(e=s(e))||"I"===e||"Y"===e}function n(e){return"A"===(e=s(e))||"E"===e||"I"===e||"O"===e||"U"===e}function c(e){return"C"===(e=s(e))||"G"===e||"P"===e||"S"===e||"T"===e}function t(e){var a=function(e){return s(e).charCodeAt(0)}(e);return a>=65&&a<=90}function s(e){return String(e).charAt(0).toUpperCase()}return function(f){var o,i,u,b,k,d="",p=0;function l(e){d+=e}function H(e){return f.charAt(p+e).toUpperCase()}function S(e){return function(){return H(e)}}if(!(f=String(f||"")))return"";for(i=S(1),u=S(0),b=S(-1);!t(u());){if(!u())return"";p++}switch(u()){case"A":"E"===i()?(l("E"),p+=2):(l("A"),p++);break;case"G":case"K":case"P":"N"===i()&&(l("N"),p+=2);break;case"W":"R"===i()?(l(i()),p+=2):"H"===i()?(l(u()),p+=2):n(i())&&(l("W"),p+=2);break;case"X":l("S"),p++;break;case"E":case"I":case"O":case"U":l(u()),p++}for(;u();)if(o=1,!t(u())||u()===b()&&"C"!==u())p+=o;else{switch(u()){case"B":"M"!==b()&&l("B");break;case"C":r(i())?"I"===i()&&"A"===H(2)?l(e):"S"!==b()&&l("S"):"H"===i()?(l(e),o++):l("K");break;case"D":"G"===i()&&r(H(2))?(l("J"),o++):l("T");break;case"G":"H"===i()?"B"===(k=s(k=H(-3)))||"D"===k||"H"===k||"H"===H(-4)||(l("F"),o++):"N"===i()?!t(H(2))||"E"===H(2)&&"D"===H(3)||l("K"):r(i())&&"G"!==b()?l("J"):l("K");break;case"H":n(i())&&!c(b())&&l("H");break;case"K":"C"!==b()&&l("K");break;case"P":"H"===i()?l("F"):l("P");break;case"Q":l("K");break;case"S":"I"!==i()||"O"!==H(2)&&"A"!==H(2)?"H"===i()?(l(e),o++):l("S"):l(e);break;case"T":"I"!==i()||"O"!==H(2)&&"A"!==H(2)?"H"===i()?(l(a),o++):"C"===i()&&"H"===H(2)||l("T"):l(e);break;case"V":l("F");break;case"W":n(i())&&l("W");break;case"X":l("KS");break;case"Y":n(i())&&l("Y");break;case"Z":l("S");break;case"F":case"J":case"L":case"M":case"N":case"R":l(u())}p+=o}return d}});